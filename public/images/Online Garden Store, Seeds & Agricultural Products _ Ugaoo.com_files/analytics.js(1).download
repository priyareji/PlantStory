var clickCounter=0;var buttonClicks=0;var scrollDepth=0;var userID,sessionID,sessionIDExpiry,headers,merchantId,callTimer=null;var apiURL="https://hits.gokwik.co";var startTime=(new Date).getTime();var expirationDuration=1e3*60*60*6;var merchantUrl=window.location.href.replace(/[{}]/g,"_");var referralURL=document.referrer?document.referrer:"";var initialize=()=>{userID=localStorage.getItem("gokwik-userID");if(userID){checkSessionId()}else{userID=`u${uuidv4()}`;localStorage.setItem("gokwik-userID",userID);checkSessionId()}initializeHeaders();setEventListeners()};console.log("dev deployed");window.onload=()=>{const checkoutHealthy=localStorage.getItem("checkoutHealthy");const buyNowButton=document.getElementById("gokwik-buy-now");if(checkoutHealthy!==null&&checkoutHealthy==="false"){window.onCheckoutClick=()=>{window.location.href="/cart/checkout"};buyNowButton&&(buyNowButton.style.display="none")}};var checkSessionId=()=>{sessionID=localStorage.getItem("gokwik-sessionID");if(sessionID){checkSessionIdExpiry()}else{createNewSessionID()}};var createNewSessionID=()=>{sessionID=`s${uuidv4()}`;localStorage.setItem("gokwik-sessionID",sessionID);setNewExpiry();createInterval()};var checkSessionIdExpiry=()=>{sessionIDExpiry=localStorage.getItem("gokwik-session-expiry");if(sessionIDExpiry){if(startTime-sessionIDExpiry>expirationDuration){createNewSessionID()}else{createInterval("checksessionid expiry")}}else{setNewExpiry();createInterval()}};var setNewExpiry=()=>{var date=(new Date).getTime()+expirationDuration;localStorage.setItem("gokwik-session-expiry",date)};var initializeHeaders=()=>{headers={Accept:"application/json","Content-Type":"application/json"}};var setEventListeners=()=>{window.addEventListener("click",event=>{clickCounter++;if(event.target.nodeName==="BUTTON"){buttonClicks++}});window.onscroll=()=>{setScroll()};document.addEventListener("visibilitychange",()=>{if(document.hidden){clearInterval(callTimer)}else{clearInterval(callTimer);createInterval("visibility changed expiry")}})};var uuidv4=()=>{return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,c=>(c^crypto.getRandomValues(new Uint8Array(1))[0]&15>>c/4).toString(16))};var setScroll=()=>{var h=document.documentElement,b=document.body,st="scrollTop",sh="scrollHeight";scrollDepth=(h[st]||b[st])/((h[sh]||b[sh])-h.clientHeight)*100};var createInterval=funcName=>{if(merchantInfo){merchantId=merchantInfo.mid}else{merchantId=document.querySelector("input[name=mid]").value}callTimer=setInterval(()=>{var body={m_id:merchantId,userId:userID,sessionId:sessionID,merchantURL:merchantUrl,clickCount:clickCounter,buttonClicks:buttonClicks,scrollDepth:isNaN(scrollDepth)?0:+scrollDepth};if(referralURL)body["referralURL"]=referralURL;fetch(`${apiURL}/api/v1/header/events/update`,{method:"POST",headers:headers,body:JSON.stringify(body)}).then(res=>{res.json().then(response=>{const responseData=response?.data?response.data:{};if(Object.hasOwnProperty.call(responseData,"checkoutHealthy")){localStorage.setItem("checkoutHealthy",response?.data?.checkoutHealthy);toggleCheckoutFunctionality(response?.data?.checkoutHealthy)}})});clickCounter=0;buttonClicks=0;setNewExpiry()},1e4)};function toggleCheckoutFunctionality(checkoutHealthy){const buyNowButton=document.getElementById("gokwik-buy-now");const gkPopup=document.getElementById("gokwik-iframe");if(checkoutHealthy){window.onCheckoutClick=e=>{const loader=e.lastElementChild;loader.setAttribute("id","btn-loader");e.disabled=true;e.style.cursor="not-allowed";gokwikSdk.initCheckout(merchantInfo);loader.style.display="flex";setTimeout(()=>{loader.style.display="none";e.disabled=false;e.style.cursor="pointer";loader.removeAttribute("id")},3e3)};buyNowButton&&(buyNowButton.style.display="block")}else{window.onCheckoutClick=()=>{window.location.href="/cart/checkout"};buyNowButton&&(buyNowButton.style.display="none");gkPopup&&window.postMessage({type:"checkoutHealth",checkoutHealthStatus:false},window.location.href)}}initialize();