var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t){t.parentNode&&t.parentNode.removeChild(t)}let c;function r(t){c=t}function l(){if(!c)throw new Error("Function called outside component initialization");return c}function d(t){l().$$.on_mount.push(t)}function u(t){l().$$.on_destroy.push(t)}const p=[],g=[];let h=[];const f=[],m=Promise.resolve();let k=!1;function w(t){h.push(t)}const y=new Set;let v=0;function $(){if(0!==v)return;const t=c;do{try{for(;v<p.length;){const t=p[v];v++,r(t),b(t.$$)}}catch(t){throw p.length=0,v=0,t}for(r(null),p.length=0,v=0;g.length;)g.pop()();for(let t=0;t<h.length;t+=1){const e=h[t];y.has(e)||(y.add(e),e())}h.length=0}while(p.length);for(;f.length;)f.pop()();k=!1,y.clear(),r(t)}function b(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(w)}}const S=new Set;function _(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];h.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),h=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function j(t,e){-1===t.$$.dirty[0]&&(p.push(t),k||(k=!0,m.then($)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function x(s,l,d,u,p,g,h){let f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[-1];const m=c;r(s);const k=s.$$={fragment:null,ctx:[],props:g,update:t,not_equal:p,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(m?m.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:l.target||m.$$.root};h&&h(k.root);let y=!1;if(k.ctx=d?d(s,l.props||{},(function(t,e){const n=!(arguments.length<=2)&&arguments.length-2?arguments.length<=2?void 0:arguments[2]:e;return k.ctx&&p(k.ctx[t],k.ctx[t]=n)&&(!k.skip_bound&&k.bound[t]&&k.bound[t](n),y&&j(s,t)),e})):[],k.update(),y=!0,o(k.before_update),k.fragment=!!u&&u(k.ctx),l.target){if(l.hydrate){const t=(_=l.target,Array.from(_.childNodes));k.fragment&&k.fragment.l(t),t.forEach(a)}else k.fragment&&k.fragment.c();l.intro&&((v=s.$$.fragment)&&v.i&&(S.delete(v),v.i(b))),function(t,n,s,a){const{fragment:c,after_update:r}=t.$$;c&&c.m(n,s),a||w((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),r.forEach(w)}(s,l.target,l.anchor,l.customElement),$()}var v,b,_;r(m)}class q{$destroy(){_(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function I(t,e){document.dispatchEvent(function(t,e){let{bubbles:n=!1,cancelable:o=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,o,e),i}(t,Object.assign({version:"3.58.0"},e),{bubbles:!0}))}class O extends q{constructor(t){if(!t||!t.target&&!t.$$inline)throw new Error("'target' is a required option");super()}$destroy(){super.$destroy(),this.$destroy=()=>{console.warn("Component was already destroyed")}}$capture_state(){}$inject_state(){}}const C=[];let E=function(e){let n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const i=new Set;function a(t){if(s(e,t)&&(e=t,n)){const t=!C.length;for(const t of i)t[1](),C.push(t,e);if(t){for(let t=0;t<C.length;t+=2)C[t][0](C[t+1]);C.length=0}}}return{set:a,update:function(t){a(t(e))},subscribe:function(s){const c=[s,arguments.length>1&&void 0!==arguments[1]?arguments[1]:t];return i.add(c),1===i.size&&(n=o(a)||t),s(e),()=>{i.delete(c),0===i.size&&n&&(n(),n=null)}}}}(!1);const N={local:"http://localhost:8080/integration.js",dev:"https://dev.pdp.gokwik.co/integration.js",hdev:"https://dev.pdp.gokwik.co/integration.js",ndev:"https://dev.pdp.gokwik.co/integration.js",qa:"https://qa.pdp.gokwik.co/integration.js",qatwo:"https://qatwo.pdp.gokwik.co/integration.js",sandbox:"https://sandbox.pdp.gokwik.co/integration.js",production:"https://pdp.gokwik.co/integration.js"},A={local:"http://localhost:8080/integration.js",dev:"https://dev-hits.gokwik.co/api/v1/events",hdev:"https://dev-hits.gokwik.co/api/v1/events",ndev:"https://dev-hits.gokwik.co/api/v1/events",qa:"https://qa-hits.gokwik.co/api/v1/events",qatwo:"https://qa-hits.gokwik.co/api/v1/events",sandbox:"https://sandbox-hits.gokwik.co/api/v1/events",production:"https://hits.gokwik.co/api/v1/events"},P={local:"https://devanalytics.gokwik.co/analytics.js",dev:"https://devanalytics.gokwik.co/analytics.js",hdev:"https://devanalytics.gokwik.co/analytics.js",ndev:"https://devanalytics.gokwik.co/analytics.js",qa:"https://qa-analytics.gokwik.co/analytics.js",qatwo:"https://qa-analytics.gokwik.co/analytics.js",sandbox:"https://sandboxanalytics.gokwik.co/analytics.js",production:"https://analytics.gokwik.co/analytics.js"},T=(t,e)=>{window.gokwikSdk.initCheckout(t),e&&D("gokwik-button-clicked","onGkClick")},J=t=>{const e=N[t];let n=document.createElement("script");n.setAttribute("src",e),n.id="gokwikIntegration",document.head.appendChild(n),n.onload=()=>M()},U=t=>{let e=!0;const n=P[t];let o=document.createElement("script");o.setAttribute("src",n),o.id="gokwikHeaderAnalytics",document.querySelectorAll("script").forEach((t=>{t.src.includes("analytics.gokwik.co/analytics.js")&&(e=!1)})),e&&document.head.appendChild(o)},M=()=>{window.addEventListener("gokwikLoaded",(()=>{E.set(!0),gokwikSdk&&gokwikSdk.on("modal_closed",(()=>{B()}))}))},H=t=>{var e;let n,o,i;o={items:[]},n=t.get("pid").split(" "),i=t.get("cp");let s={};if(n){n.map((t=>{s[t]?s[t]+=1:s[t]=1}));Object.keys(s).map((t=>{o.items.push({id:t,quantity:s[t]})}))}return null!==(e=o.items)&&void 0!==e&&e.length&&(i?F("discount_code",i):F("discount_code","",-1)),{pageProducts:n,pageItem:o,pageCoupon:i,productUrl:undefined}},L=function(){var t;let e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>2?arguments[2]:void 0,i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];o&&null!==(t=o.items)&&void 0!==t&&t.length?(i.checkoutType="headless",e=JSON.stringify(o)):e=a.length?JSON.stringify({items:a}):window.productFormSelector?JSON.stringify(X(document.querySelector(window.productFormSelector))):JSON.stringify(R()),n&&(e=X(document.querySelector(n)),e=JSON.stringify(e)),G("POST","/cart/add.js",JSON.parse(e),(function(t){200==t&&(T(i,!1),s.items,localStorage.setItem("gkbuynow","active"))}))},R=()=>{const t=document.querySelector('[action="/cart/add"]'),e=X(t);var n,o;e.id||(e.id=null===(n=document.querySelector('[name="id"]'))||void 0===n?void 0:n.value);e.quantity||(e.quantity=null===(o=document.querySelector('[name="quantity"'))||void 0===o?void 0:o.value);return e.form_type="product",e.utf8="âœ“",e},B=()=>{let t=JSON.parse(localStorage.getItem("cartItems")||"{}");if(t&&t.length){let e={items:t};localStorage.removeItem("gkbuynow"),G("POST","/cart/clear.js","",(function(t){200===t&&G("POST","/cart/add.js",e,(function(t){200==t&&localStorage.removeItem("cartItems")}))}))}else"active"===localStorage.getItem("gkbuynow")&&G("POST","/cart/clear.js","",(()=>{localStorage.removeItem("gkbuynow")}))},D=(t,e)=>{let n=A[window.merchantInfo.environment],o=Date.now(),i=navigator.userAgent,s=window.merchantInfo.mid,a=t,c=e,r=z("_shopify_sa_p"),l=localStorage.getItem("gokwik-sessionID"),d={timestamp:o,userAgent:i,version:"1",merchantId:s,name:a,sessionId:l,type:"event",adSource:r,eventType:c};l||delete d.sessionId,r||delete d.adSource,G("POST",n,d,((t,e)=>{}))},G=async(t,e,n,o)=>{let i=new XMLHttpRequest;i.open(t,e,!0),i.setRequestHeader("Content-type","application/json"),i.onload=function(){let t=i.status,e=i.response;o(t,e)},i.send(n?JSON.stringify(n):null)},z=t=>{let e=t+"=",n=document.cookie.split(";");for(let t=0;t<n.length;t++){let o=n[t];for(;" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return""},F=(t,e,n)=>{let o="";if(n){let t=new Date;t.setTime(t.getTime()+24*n*60*60*1e3),o="; expires="+t.toUTCString()}document.cookie=t+"="+(e||"")+o+"; path=/"},X=t=>{let e={},n=t.querySelectorAll("input, select, textarea");for(let t=0;t<n.length;++t){let o=n[t],i=o.name,s=o.value;i&&(e[i]=s)}return e};function K(e){const n={c:t,l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:t,p:t,i:t,o:t,d:t};return I("SvelteRegisterBlock",{block:n,id:K.name,type:"component",source:"",ctx:e}),n}function Q(t,e,n){let o,i,s,a,{$$slots:c={},$$scope:r}=e;!function(t,e,n){for(const o of Object.keys(e))~n.indexOf(o)||console.warn("<".concat(t,'> received an unexpected slot "').concat(o,'".'))}("Main",c,[]);const l=window.merchantInfo;d((()=>{J(l.environment);const t=new URLSearchParams(window.location.search);t.get("pid")&&(({pageProducts:o,pageItem:i,pageCoupon:s,productUrl:a}=H(t)),E.subscribe((t=>{t&&i.items.length&&p(!1)}))),window.onload=()=>{U(l.environment)}}));const p=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];G("GET","/cart.js","",(function(n,c){var r=JSON.parse(c);if(200===n&&r.item_count){var d=r.items.map((t=>({id:t.id,quantity:t.quantity,options_with_values:t.options_with_values})));localStorage.setItem("cartItems",JSON.stringify(d)),G("POST","/cart/clear.js","",(function(n){200===n&&L(t,o,i,s,a,l,r,e)}))}else L(t,o,i,s,a,l,r,e)}))};window.onCheckoutClick=t=>{const e=t.lastElementChild;e.setAttribute("id","btn-loader"),t.disabled=!0,t.style.cursor="not-allowed",T(window.merchantInfo,!0),e.style.display="flex",setTimeout((()=>{e.style.display="none",t.disabled=!1,t.style.cursor="pointer",e.removeAttribute("id")}),3e3)},window.onBuyNowClick=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];D("gk_buy_now_button_clicked","onGkClick");const o=t.children[0];o.setAttribute("id","btn-loader"),t.disabled=!0,t.style.cursor="not-allowed",p(e,n),o.style.display="flex",setTimeout((()=>{o.style.display="none",t.disabled=!1,t.style.cursor="pointer",o.removeAttribute("id")}),3e3)};const g=[];return Object.keys(e).forEach((t=>{~g.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn("<Main> was created with unknown prop '".concat(t,"'"))})),t.$capture_state=()=>({onDestroy:u,onMount:d,addCartBuyNow:L,createHeaderAnalyticsScript:U,createIntegrationScript:J,getHeadlessParams:H,initiateGokwik:T,logEvent:D,makeXhr:G,store_gokwikLoaded:E,pageProducts:o,pageItem:i,pageCoupon:s,productUrl:a,merchantInfo:l,gokwikBuyNow:p}),t.$inject_state=t=>{"pageProducts"in t&&(o=t.pageProducts),"pageItem"in t&&(i=t.pageItem),"pageCoupon"in t&&(s=t.pageCoupon),"productUrl"in t&&(a=t.productUrl)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[]}return new class extends O{constructor(t){super(t),x(this,t,Q,K,s,{}),I("SvelteRegisterComponent",{component:this,tagName:"Main",options:t,id:K.name})}}({target:window.parent})}();
